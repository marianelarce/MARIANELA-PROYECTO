<!DOCTYPE html>
<html lang="es">

<head>
  <script async src="./assets/js/isLogged.js"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mascotas - Formulario</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <link rel="stylesheet" href="./assets/css/mascotas.css">
</head>

<body class ="bg-formulario">
  <nav class="navbar navbar-expand-md bg-primary" data-bs-theme="dark">
    <div class="container-fluid">
      <a class="navbar-brand rounded-1 border-start border-end border-white border-4" style="background-image: url(./assets/images/logozoonosis.png); background-size: 100% 100%; width: 130px; height: 34px;"></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-md-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page">Mascotas</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="./lista-mascotas.html">Ver registros</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="./reporte.html">Reporte</a>
          </li>
        </ul>
        <a class="btn btn-primary border border-white" id="nav_btn_logout"><i class="bi bi-arrow-bar-right pe-1"></i>
          Salir</a>
      </div>
    </div>
  </nav>

  <div class="container mt-4">
    <div class="row justify-content-center mb-5">
      <div class="col-8 bg-white shadow rounded py-2">
        <h1 class="text-center pb-4">Formulario de registro de mascotas</h1>
        <h2 class="text-center pb-4">Centro Municipal de Zoonosis Sacaba</h2>
        <form id="form_mascotas">
          <!-- 1: a -->
          <fieldset class="border p-3 rounded">
            <div class="row">
              <div class="col-6">
                <div class="row mb-3">
                  <label for="a_codigo" class="col-sm-3 col-form-label">Código:</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" id="a_codigo" name="a_codigo" required>
                  </div>
                </div>
              </div>
              <div class="col-6">
                <div class="row mb-3">
                  <label for="a_fecha" class="col-sm-3 col-form-label">Fecha:</label>
                  <div class="col-sm-9">
                    <input type="date" class="form-control" id="a_fecha" name="a_fecha" required>
                  </div>
                </div>
              </div>
              <div class="col-6">
                <div class="row mb-3">
                  <label for="a_propietario" class="col-sm-3 col-form-label">Propietario:</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" id="a_propietario" name="a_propietario" required>
                  </div>
                </div>
              </div>
              <div class="col-6">
                <div class="row mb-3">
                  <label for="a_zona" class="col-sm-4 col-form-label">Zona (Dirección):</label>
                  <div class="col-sm-8">
                    <input type="text" class="form-control" id="a_zona" name="a_zona" required>
                  </div>
                </div>
              </div>
            </div>

            <fieldset class="p-0">
              <div id="map" style="width: 100%; height: 500px;"></div>
              <p id="location">Latitud: -, Longitud: -</p>
              <input type="hidden" class="form-control" id="a_latitud" name="a_latitud">
              <input type="hidden" class="form-control" id="a_longitud" name="a_longitud">
              <!-- <div class="row">
                <div class="col-6">
                  <div class="row mb-3">
                    <label class="col-sm-3 col-form-label">Latitud:</label>
                    <div class="col-sm-9">
                      <input type="text" class="form-control" id="a_latitud" name="a_latitud" required disabled>
                    </div>
                  </div>
                </div>
                <div class="col-6">
                  <div class="row mb-3">
                    <label class="col-sm-4 col-form-label">Longitud:</label>
                    <div class="col-sm-8">
                      <input type="text" class="form-control" id="a_longitud" name="a_longitud" required disabled>
                    </div>
                  </div>
                </div>
              </div> -->
            </fieldset>

            <div class="row">
              <div class="col-8">
                <div class="row mb-3">
                  <label for="a_motivo" class="col-sm-2 col-form-label">Motivo:</label>
                  <div class="col-sm-10">
                    <select class="form-control" id="a_motivo" name="a_motivo">
                      <option value="">-- elija una opción --</option>
                      <option value="Entrega">Entrega</option>
                      <option value="Denuncia">Denuncia</option>
                      <option value="Captura">Captura</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="col-4">
                <input type="text" class="form-control" id="a_motivo_otro" name="a_motivo_otro" placeholder="( otro motivo )">
              </div>
            </div>

          </fieldset>

          <!-- 2: b -->
          <fieldset class="border p-3 rounded mt-3">
            <legend class="float-none w-auto px-3">Características del animal</legend>

            <div class="row">
              <div class="col-12">
                <div class="row mb-3">
                  <label for="b_imagen" class="col-sm-2 col-form-label">Fotografía:</label>
                  <div class="col-sm-10">
                    <input type="file" class="form-control" id="b_imagen" name="b_imagen" required>
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-4">
                <div class="row mb-3">
                  <label for="b_nombre" class="col-sm-3 col-form-label">Nombre:</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" id="b_nombre" name="b_nombre" required>
                  </div>
                </div>
              </div>
              <div class="col-4">
                <div class="row mb-3">
                  <label for="b_raza" class="col-sm-3 col-form-label">Raza:</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" id="b_raza" name="b_raza" required>
                  </div>
                </div>
              </div>
              <div class="col-4">
                <div class="row mb-3">
                  <label for="b_color" class="col-sm-3 col-form-label">Color:</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" id="b_color" name="b_color" required>
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-6">
                <div class="row mb-3">
                  <label for="b_especie" class="col-sm-3 col-form-label">Especie:</label>
                  <div class="col-sm-9">
                    <select class="form-select" id="b_especie" name="b_especie" required>
                      <option value="">-- elija una opción --</option>
                      <option value="Canino">Canino</option>
                      <option value="Felino">Felino</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="col-6">
                <div class="row mb-3">
                  <label for="b_sexo" class="col-sm-3 col-form-label">Sexo:</label>
                  <div class="col-sm-9">
                    <select class="form-select" id="b_sexo" name="b_sexo" required>
                      <option value="">-- elija una opción --</option>
                      <option value="Hembra">Hembra</option>
                      <option value="Macho">Macho</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </fieldset>

          <!-- 7: g -->
          <fieldset class="border p-3 rounded mt-3">
            <legend class="float-none w-auto px-3">Carnet de vacunación</legend>

            <div class="row">
              <div class="col-4">
                <div class="row mb-3">
                  <label for="g_carnet" class="col-sm-4 col-form-label">Carnet:</label>
                  <div class="col-sm-8">
                    <select class="form-select" id="g_carnet" name="g_carnet" required>
                      <option value="">-- elija una opción --</option>
                      <option value="Si">Si</option>
                      <option value="No">No</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="col-8">
                <div class="row mb-3">
                  <label for="g_fecha_vcr" class="col-sm-7 col-form-label text-end">Fecha vacunación contra la rabia:</label>
                  <div class="col-sm-5">
                    <input type="date" class="form-control" id="g_fecha_vcr" name="g_fecha_vcr" required>
                  </div>
                </div>
              </div>
            </div>
          </fieldset>

          <!-- 3: c -->
          <fieldset class="border p-3 rounded mt-3">
            <legend class="float-none w-auto px-3">Estado del animal</legend>

            <div class="row px-3">
              <select class="form-select" id="c_estado_animal" name="c_estado_animal" required>
                <option value="">-- elija una opción --</option>
                <option value="Sano">Sano</option>
                <option value="Celo">Celo</option>
                <option value="Enfermedad leve">Enfermedad leve</option>
                <option value="Enfermedad grave">Enfermedad grave</option>
                <option value="Enfermedad terminal">Enfermedad terminal</option>
                <option value="Moribundo">Moribundo</option>
                <option value="Recojo de restos cadavericos">Recojo de restos cadavéricos</option>
                <option value="Miasis">Miasis</option>
                <option value="Atropellado">Atropellado</option>
              </select>
            </div>
          </fieldset>

          <!-- 4: d -->
          <fieldset class="border p-3 rounded mt-3">
            <legend class="float-none w-auto px-3">Observaciones</legend>
            <div>
              <textarea class="form-control" id="d_observacion" rows="3" name="c_observacion" required></textarea>
            </div>
          </fieldset>

          <!-- 5: e -->
          <fieldset class="border p-3 rounded mt-3">
            <legend class="float-none w-auto px-3">Retirado</legend>

            <div class="row">
              <div class="col-7">
                <div class="row mb-3">
                  <label for="e_nombre" class="col-sm-3 col-form-label">Nombre:</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" id="e_nombre" name="e_nombre">
                  </div>
                </div>
              </div>
              <div class="col-5">
                <div class="row mb-3">
                  <label for="e_fecha" class="col-sm-3 col-form-label">Fecha:</label>
                  <div class="col-sm-9">
                    <input type="date" class="form-control" id="e_fecha" name="e_fecha">
                  </div>
                </div>
              </div>
            </div>
          </fieldset>

          <!-- 6: f -->
          <fieldset class="border p-3 rounded mt-3">
            <legend class="float-none w-auto px-3">Adopción</legend>

            <div class="row">
              <div class="col-7">
                <div class="row mb-3">
                  <label for="f_nombre" class="col-sm-3 col-form-label">Nombre:</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" id="f_nombre" name="f_nombre">
                  </div>
                </div>
              </div>
              <div class="col-5">
                <div class="row mb-3">
                  <label for="f_fecha" class="col-sm-3 col-form-label">Fecha:</label>
                  <div class="col-sm-9">
                    <input type="date" class="form-control" id="f_fecha" name="f_fecha">
                  </div>
                </div>
              </div>
              <div class="col-5">
                <div class="row mb-3">
                  <label for="f_p_s_normativa" class="col-sm-12 col-form-label">Procedimiento según Normativa:</label>
                  <!-- <div class="col-sm-5">
                    <input type="text" class="form-control" id="f_p_s_normativa" name="f_ps_normativa" required>
                  </div> -->
                </div>
              </div>
              <div class="col-7">
                <div class="row mb-3">
                  <label for="f_fecha_dos" class="col-sm-2 col-form-label text-end">Fecha:</label>
                  <div class="col-sm-10">
                    <input type="date" class="form-control" id="f_fecha_dos" name="f_fecha_dos">
                  </div>
                </div>
              </div>
            </div>
          </fieldset>

          <!-- : -->
          <!-- <fieldset class="border p-3 rounded mt-3">
            <div id="map" style="width: 100%; height: 500px;"></div>
            <p id="location">Latitud: -, Longitud: -</p>

          </fieldset> -->
          <div>
            <button type="submit" class="btn btn-primary mt-3 px-5">Guardar</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
  <script>
    let map;
    let marker;
    let geocoder;

    async function initMap() {
      // Inicializar el mapa centrado en una ubicación predeterminada
      const { Map } = await google.maps.importLibrary("maps");
      const initialLocation = { lat: -17.406661645815724, lng: -66.0456363912436 };
      map = new Map(document.getElementById("map"), {
        center: initialLocation,
        zoom: 14,
        mapId: "DEMO_MAP_ID",
      });

      // Inicializar el geocodificador
      // geocoder = new google.maps.Geocoder();
      // Agregar un marcador personalizado (inicialmente oculto)


      const { AdvancedMarkerElement, PinElement } = await google.maps.importLibrary("marker");
      const beachFlagImg = document.createElement("img");

      beachFlagImg.src = "./assets/images/marcador.png";
      beachFlagImg.setAttribute("style", "width: 32px; height: 32px;");
      beachFlagImg.setAttribute("alt", "Ubicación");
      marker = new AdvancedMarkerElement({
        map,
        // position: initialLocation,
        content: beachFlagImg,
        title: "Ubicación",
      });
      // const icon = {
      //   url: "./assets/images/marcador.png", // url
      //   scaledSize: new google.maps.Size(30, 30), // scaled size
      //   origin: new google.maps.Point(0,0), // origin
      //   anchor: new google.maps.Point(15, 30) // anchor
      // };
      // marker = new google.maps.Marker({
      //     position: initialLocation,
      //     map: map,
      //     icon: icon, // Reemplaza con la URL de tu icono personalizado
      //     visible: false, // Inicialmente oculto

      // });

      // Detectar clics en el mapa
      map.addListener("click", (event) => {
        placeMarker(event.latLng);
        // getPlaceName(event.latLng);
      });
    }

    function placeMarker(location) {
      // Mostrar y mover el marcador a la ubicación seleccionada
      // marker.setPosition(location);
      // marker.setVisible(true);

      marker.position = location;

      // Actualizar la información de latitud y longitud
      document.getElementById("location").innerText =
        `Latitud: ${location.lat()}, Longitud: ${location.lng()}`;
      document.getElementById("a_latitud").value = location.lat();
      document.getElementById("a_longitud").value = location.lng();
    }

    // function getPlaceName(location) {
    //       geocoder.geocode({ location: location }, (results, status) => {
    //           if (status === "OK") {
    //               if (results[0]) {
    //                   const placeName = results[0].formatted_address;
    //                   document.getElementById("location").innerText =
    //                       `Nombre del lugar: ${placeName}, Latitud: ${location.lat()}, Longitud: ${location.lng()}`;
    //               } else {
    //                   document.getElementById("location").innerText = "No se encontraron resultados.";
    //               }
    //           } else {
    //               console.error("Geocoder falló debido a: " + status);
    //               document.getElementById("location").innerText = "Error al obtener el nombre del lugar.";
    //           }
    //       });
    //   }
  </script>
  <script async
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD0VTNda_a3vnGdnKZ9IahKiOgMyQ2KMJU&callback=initMap"></script>
  <script src="./assets/js/mascotas.js"></script>

</body>

</html>